pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
function _init()
	widescreen=false
	main_x=0
	main_spd=1
	mtn_x=0
	mtn_spd=0.3
	cloud_x=0
	cloud_spd=0.6
	heart={
		pos=40,
		dy=0,
		max_y=4,
		accel=0.8,
		up=true
	}
	birds={}
	make_bird(4,24,0.5)
	make_bird(12,32,0.5)
	inara={
		s={3,35},
		pos=32,
		pl=0
	}
	dad={
		s={2,34},
		pos=16,
		pl=12
	}
	mom={
		s={25,41},
		pos=48,
		pl=10
	}
	f=1
	fspd=3
	tick=0
	if widescreen then
		ymap=32     --map y-coord
	else
		ymap=0
	end
	ypos=ymap+48 --ground level
	music(1)
end

function _update()
	-- map positions
	main_x-=main_spd
	if main_x<-127 then main_x=0 end
	mtn_x-=mtn_spd
	if mtn_x<-255 then mtn_x=0 end
	cloud_x-=cloud_spd
	if cloud_x<-127 then cloud_x=0 end

	-- sprite animations
	if tick<fspd then
		tick+=1
	else
		tick=0
		if f==1 then
			f=2
		else
			f=1
		end
	end

	-- heart bounce
	if heart.up then
		if abs(heart.dy)<heart.max_y then
			heart.dy-=heart.accel
		else
			heart.up=false
		end
	else
		if abs(heart.dy)>0 then
			heart.dy+=heart.accel
		else
			heart.up=true
		end
	end
	
	--birds
	for i in all(birds) do
		i:update()
	end
end

function _draw()
	cls(12)
	
	--sun
	spr(28,16,ymap+8,2,2)
	
	-- maps
	map(16,0,mtn_x,ymap,16,8)
	map(16,0,mtn_x+256,ymap,16,8)
	map(16,8,cloud_x,ymap,16,8)
	map(16,8,cloud_x+128,ymap,16,8)
	map(0,0,main_x,ymap,16,16)
	map(0,0,main_x+128,ymap,16,16)
	
	--people
	for i in all({inara,dad,mom}) do
		palt(0,false)
		palt(i.pl,true)
		spr(i.s[f],i.pos,ypos,1,1)
		palt()
	end
	
	--heart
	spr(1,heart.pos,ypos+heart.dy,1,1)
	
	--birds
	for i in all(birds) do
		i:draw()
	end
	
	--black bars
	if ymap!=0 then
		rectfill(0,0,127,31,0)
		rectfill(0,96,127,127,0)
	end
end
-->8
function make_bird(_x,_y,_spd)
	add(birds,{
		x=_x,
		y=_y,
		s={32,33},
		spd=_spd,
		pl=12,
		update=function(self)
			self.x+=self.spd
			if self.x>127 then
				--del(birds,self)
				self.x=-32
			end
		end,
		draw=function(self)
			palt(0,false)
			palt(self.pl,true)
			spr(self.s[f],self.x,self.y+ymap,1,1)
			palt()
		end
	})
end
__gfx__
0000000000000000ccc0000c000eee0033333333444449440000000000000006600000000000000550000000000000077000000000aaaaa00000000000000000
0000000008808800cccf0f0c00e1f100444444444444444400eeeee000000066660000000000005555000000000000777700000000a444a00000000000000000
0070070088888880cccffffc0eefff00449444444944444400eaaae000000666666000000000055555500000000007777770000000a444a00000000000000000
0007700088888880cccc1ccc00022000449499444449494400eaaae000006666666600000000555555550000000077777777000000aa3aa00000000000000000
0007700008888800ccf111fc0f2222f0444444444944444400eebee0000666666666600000055555555550000007777777777000000030000000000000000000
0070070000888000cccc1ccc0002200044444444666666960000b000006666666666660000555555555555000077777777777700000030000000000000000000
0000000000080000cccdcdcc000dd000449449446556666500bbbbb0066666666666666005555555555555500777777777777770003333300000000000000000
0000000000000000ccdcccdc000d0d00444444445555555500bbbbb0666666666666666655555555555555557777777777777777003333300000000000000000
00090900000000007777777700bbbbb00000400000aaaaa0666666665555555565555555aa44444a000000777000000000009090909090000000000000000000
00090900000000007777777700bbbbb00044444000a444a0666666665555555566555555aa40f04a000007777700000000009090909090000000000000000000
00aaaa00000000007777777700bbbbb00000400000a444a0666666665555555566655555a4afffa4000777777770000000009090909090000000000000000000
99aaaa99000000007777777700bb4bb00044444000aabaa0666666665555555566665555aaaaeaaa00777777777770000000aaaaaaaaa9990000000000000000
00aaaa00000000007777777700444440000040000000b000666666665555555566666555aafeeefa00777777777777000999a9999999a0000000000000000000
99aaaa990000000077777777000040000044444004444440666666665555555566666655aaaaeaaa00777777777777000000a9999999a9990000000000000000
009090900000000077777777004444400000400000444400666666665555555566666665aa88a8aa00077777777777000999a9999999a0000000000000000000
009090900000000077777777000040000000400000444400666666665555555566666666aaaaa8aa00000777700000000000a9999999a9990000000000000000
ccccccccccccccccccc0000c000eee000000000000000000000000000000000000000000aa44444a00000000000000000999a9999999a0000000000000000000
cc77cccccccccccccccf0f0c00e1f1000000000000000000000000000000000000000000aa40f04a00000000000000000000a9999999a9990000000000000000
cc77ccccc77770cccccffffc0eefff000000000000000000000000000000000000000000a4afffa400000000000000000999aaaaaaaaa0000000000000000000
c77770ccc777799ccccc1ccc000220000000000000000000000000000000000000000000aaaaeaaa000000000000000000009090909090000000000000000000
c777799ccc77ccccccf111fc0f2222f00000000000000000000000000000000000000000aafeeefa000000000000000000009090909090000000000000000000
cccccccccc77cccccccc1ccc000220000000000000000000000000000000000000000000aaaaeaaa000000000000000000009090909090000000000000000000
ccccccccccccccccccddcdcc000dd0000000000000000000000000000000000000000000aaa8a8aa000000000000000000000000000000000000000000000000
cccccccccccccccccccccdcc00d0d0000000000000000000000000000000000000000000aa8aaa8a000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000708000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000071616080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000007161616160800000b0c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00130000000000000000000000000000000007161616161616080917170a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00140000000000150d060d060d060d0000071616161616161616181717170a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04040404040404040404040404040404000000000000001a1b00001a1b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
040404040404040404040404040404040000000000000000001a1b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0404040404040404040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0504050404040404040404040504040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0405040504050405050505050405050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000200000b000140001d0001700001000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
002000000c0540c0500c0500c0400c0300c0200c01509000090540905009050090400903009020090150000007054070500705007040070300702007015000000505405050050500504005030050250000000000
002000001c0541c0501c0501c0401c0301c0201c015090001f0541f0501f0501f0401f0301f0201f0150000024054240502405024040240302402024015000001f0541f0501f0501f0401f0301f0250000000000
0110000818775187751c7751c7751f7751f7751c7751f77518700187001c7001c7001f7001f7001c7001f70018700187001c7001c7001f7001f7001c7001f70018700187001c7001c7001f7001f7001c7001f700
0110002000653136500c653006531f6500e653006331c63000653246530e653006531f650006530c6530e65300653136500c653006531f6500e653006331f65000653246530e653006531a650006530c6531d643
011000202416224162241621c1651f1651f1651c1651f16518165181651c1651f1622416226162281621f1621f1621f1621c1651c1651f1651f1651c1651f16518165181651c1651f1621d1621c1621a1621f165
0110002000653136500c653006532b6500e653006331c63000653246530e653006532b650006530c6530e65300653136500c653006532b6500e653006331f65000653246530e653006532b650006530c6531d643
__music__
03 01020304
00 01020304
00 01020304
03 01020506

